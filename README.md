## 🔒 LawScrapper v1.1.0

**LawScrapper** is an automated legal monitoring and summarization pipeline. It periodically checks for new legal acts published by the Polish Sejm, filters them by topic (e.g., fire safety), summarizes their content using an LLM (OpenAI GPT-4.1 via LangChain), and sends email notifications with formatted summaries.

## 🚀 Features

✅ Fetches recent legal acts using Sejm API  
✅ Filters acts by keywords with duplicate removal  
✅ Automatically downloads PDF versions of the acts  
✅ Extracts and summarizes content with OpenAI GPT-4.1 (via LangChain)  
✅ Sends email notifications with summaries and metadata in a styled HTML table  
✅ LangGraph-based pipeline to handle conditional workflows (e.g., if no acts found)  
✅ Singleton logger pattern for consistent logging across all modules  
✅ Comprehensive error handling and logging  
✅ External prompt templates for customizable AI summaries  
✅ Flexible logging configuration (console or file output)  

## 🛠 Requirements
Install dependencies (Python ≥ 3.10 recommended):

```bash
pip install -r requirements.txt
```

Also make sure to configure environment variables:

```bash
OPENAI_API_KEY=...
SMTP_SERVER=...
SMTP_PORT=...
SMTP_USER=...
SMTP_PASSWORD=...
SMTP_FROM=...
SMTP_TO=...
```

You will need access to OpenAI's GPT-4.1 model via LangChain integration (langchain-openai).

### 📺 How to use
You can manually run the workflow from main.py:

```bash
python main.py
```

It will:  
✅ Fetch recent acts from the last week.  
✅ If acts are found, each one is summarized.  
✅ A summary notification is sent via email.  
✅ If no acts are found, a separate info message is sent.  
✅ You can adjust the keyword(s) and time range directly in the script logic.

### ⚙️ Configuration
- **Logging**: Change `Logger(to_file=False)` in `main.py` to log to console instead of files
- **AI Prompts**: Customize summarization by editing `prompts/summary.md`
- **Keywords**: Modify the keywords list in `main.py` to filter different types of legal acts
- **Time Range**: Use different scrapper methods (`get_acts_from_last_month`, `get_acts_from_current_month`, etc.)

## 🔹 Project structure

```bash
LawScrapper/
├── .github/workflows/run_scrapper.yml  # GitHub Actions CI (optional)
├── main.py                             # Entry point (LangGraph workflow definition)
├── model.py                            # LLM summarization logic (OpenAI + PDF handling)
├── scrapper.py                         # Sejm API client and data formatter
├── send_notification.py                # Styled HTML email sender via SMTP
├── logger.py                           # Singleton logger for consistent logging
├── prompts/                            # External prompt templates for AI
│   └── summary.md                      # Legal act summarization prompt
├── logs/                               # Directory for log files
├── venv/                               # Virtual environment
├── requirements.txt                    # Python dependencies
├── LICENSE                             # MIT License
├── .env                                # Environment variables (not versioned)
```

### 📂 Output

Email summaries are sent to the configured recipient (SMTP_TO) and contain:  
1) Title,  
2) Summary (generated by LLM),  
3) Dates (e.g., entry into force date),  
4) Keywords,  
5) Link to PDF/HTML text of the act  

## 📝 Changelog

### v1.1.0 (2025-06-22)
🎉 **Major improvements in data handling and logging:**
- ✅ **Fixed duplicate removal** - Now correctly handles multiple keywords without creating duplicate acts
- ✅ **Singleton Logger pattern** - Unified logging across all modules with consistent file naming
- ✅ **Improved scrapper logic** - Enhanced deduplication using ELI identifiers
- ✅ **Better error handling** - More robust error handling throughout the pipeline
- ✅ **Optimized performance** - Reduced redundant API calls and improved memory usage
- ✅ **External prompt templates** - AI prompts moved to separate `prompts/` directory for easy customization
- ✅ **Flexible logging** - Configurable console or file logging via `to_file` parameter
- ✅ **Timestamp-based log files** - Unique log file names with timestamp for better tracking

### v1.0.0 (Initial Release)
- 🚀 Basic legal act scraping and summarization functionality
- 📧 Email notifications with HTML formatting
- 🤖 LangGraph workflow integration
- 🔍 Keyword-based filtering

## 📍 Planned improvements
1) CLI support for scheduling or manual triggering,  
2) Persistent database (e.g., SQLite) to track already processed acts  
3) Web dashboard for monitoring and configuration  
4) Support for multiple notification channels (Slack, Teams, etc.)  

## 👤 Author
Made with ❤️ by Michał Kamiński

## 🧾 License
This project is licensed under the MIT License.  
You are free to use, modify, and distribute it as you wish.